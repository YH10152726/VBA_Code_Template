Sub 必須作業_TS出力()

    Dim wsExtra As Worksheet, wsOutput As Worksheet
    Set wsExtra = Worksheets("追加情報")
    Set wsOutput = Worksheets("TS出力")

    Dim 接触面数 As Long
    Dim 複雑度 As String
    Dim baseRow As Long
    baseRow = wsOutput.Cells(wsOutput.Rows.Count, "B").End(xlUp).Row + 3

    ' 接触面数の読み取り
    接触面数 = wsExtra.Range("C2").Value

    ' 複雑度の自動変換（D2に書き込む）
    If 接触面数 <= 10 Then
        複雑度 = "標準"
    ElseIf 接触面数 <= 20 Then
        複雑度 = "中"
    Else
        複雑度 = "高"
    End If
    wsExtra.Range("D2").Value = 複雑度

    ' 複雑度による時間設定
    Dim 擦合時間 As Double, 仮組時間 As Double, 本組時間 As Double
    Select Case 複雑度
        Case "標準": 擦合時間 = 3: 仮組時間 = 12: 本組時間 = 2
        Case "中": 擦合時間 = 4: 仮組時間 = 16: 本組時間 = 2.5
        Case "高": 擦合時間 = 5: 仮組時間 = 20: 本組時間 = 3
    End Select

    ' TS出力に追記
    With wsOutput
        .Cells(baseRow, 2).Value = "モールドベース確認"
        .Cells(baseRow, 4).Value = 1 ' ← サイズ補正はあとで対応可
        baseRow = baseRow + 1

        .Cells(baseRow, 2).Value = "単品擦り合わせ"
        .Cells(baseRow, 4).Value = 擦合時間
        baseRow = baseRow + 1

        .Cells(baseRow, 2).Value = "仮組み擦り合わせ"
        .Cells(baseRow, 4).Value = 仮組時間
        baseRow = baseRow + 1

        .Cells(baseRow, 2).Value = "清掃"
        .Cells(baseRow, 4).Value = 1
        baseRow = baseRow + 1

        .Cells(baseRow, 2).Value = "本組み"
        .Cells(baseRow, 4).Value = 本組時間
        baseRow = baseRow + 1
    End With

    MsgBox "必須作業のTSを出力しました（複雑度：" & 複雑度 & "）", vbInformation

End Sub